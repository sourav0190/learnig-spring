<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Dashboard - Banking Portal</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="#" class="nav-brand">MJM Banking</a>
            <div class="nav-links">
                <span th:text="${username}">User</span>
                <a th:href="@{/logout}">Logout</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Account Overview -->
        <div class="card">
            <h2>Account Overview</h2>
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <p style="color: #6b7280; margin-bottom: 0.5rem;">Total Balance</p>
                    <h1 style="font-size: 2.5rem; margin: 0; color: #111827;" th:text="${'$' + account.balance}">$0.00</h1>
                </div>
                <div>
                    <p style="color: #6b7280; margin-bottom: 0.5rem;">Account Number</p>
                    <h3 th:text="${account.accountNumber}">1234567890</h3>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
            <!-- Deposit -->
            <div class="card">
                <h3>Deposit Funds</h3>
                <form th:action="@{/deposit}" method="post">
                    <div class="form-group">
                        <label>Amount</label>
                        <input type="number" name="amount" class="form-input" min="1" step="0.01" required>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%">Deposit</button>
                </form>
            </div>

            <!-- Withdraw -->
            <div class="card">
                <h3>Withdraw Funds</h3>
                <form th:action="@{/withdraw}" method="post">
                    <div class="form-group">
                        <label>Amount</label>
                        <input type="number" name="amount" class="form-input" min="1" step="0.01" required>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%; background-color: #ef4444;">Withdraw</button>
                </form>
            </div>

            <!-- Transfer -->
            <div class="card">
                <h3>Transfer Funds</h3>
                <form th:action="@{/transfer}" method="post">
                    <div class="form-group">
                        <label>To Username</label>
                        <input type="text" name="toUser" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label>Amount</label>
                        <input type="number" name="amount" class="form-input" min="1" step="0.01" required>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%; background-color: #8b5cf6;">Transfer</button>
                </form>
            </div>
        </div>

        <!-- Transaction History -->
        <div class="card" style="margin-top: 2rem;">
            <h3>Recent Transactions</h3>
            <table style="width: 100%; text-align: left; border-collapse: collapse;">
                <thead>
                    <tr style="border-bottom: 1px solid #e5e7eb;">
                        <th style="padding: 1rem 0;">Type</th>
                        <th style="padding: 1rem 0;">Amount</th>
                        <th style="padding: 1rem 0;">Date</th>
                        <th style="padding: 1rem 0;">Details</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="transaction : ${transactions}" style="border-bottom: 1px solid #f3f4f6;">
                        <td style="padding: 1rem 0;">
                            <span th:text="${transaction.type}" 
                                  th:style="${transaction.type == 'DEPOSIT' ? 'color: var(--success-color); font-weight: bold;' : (transaction.type == 'WITHDRAW' ? 'color: var(--danger-color); font-weight: bold;' : 'color: #8b5cf6; font-weight: bold;')}">
                                TYPE
                            </span>
                        </td>
                        <td th:text="${'$' + transaction.amount}" style="padding: 1rem 0;">$0.00</td>
                        <td th:text="${#temporals.format(transaction.timestamp, 'yyyy-MM-dd HH:mm')}" style="padding: 1rem 0;">Date</td>
                        <td style="padding: 1rem 0;">
                            <span th:if="${transaction.type == 'TRANSFER'}" 
                                  th:text="${transaction.sourceAccount.id == account.id ? 'To ' + transaction.targetAccount.user.username : 'From ' + transaction.sourceAccount.user.username}">
                            </span>
                            <span th:unless="${transaction.type == 'TRANSFER'}">-</span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>
